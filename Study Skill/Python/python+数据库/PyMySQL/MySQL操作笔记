# MySQL操作笔记
# 阅读方式：顶格为系统输出，缩进一次是命令输入，缩进两次为注释(用三个引号包裹)，其中包括"#"之后也为注释，类似与python写法


        """
        ___________命令汇总__________

        登录
            mysql -h localhost -u root -p****

        退出
            \g
            exit

        帮助
            \h

        显示系统信息
            \s\s\cr

        展示所有数据库
            show databases;

        新建数据库
            create database dome;

        删除数据库
        drop database dome

        查看当前选择的数据库
            select database();

        选择数据库-----205
            use dome;

        展示数据库的建库语句
            show create database dome\G;  # 后面的"\G"加上为以文本格式展示

        查看建表语句
            show create table test\G

        新建表
            create table test(m1 int, m2 varchar(8), ...);

        查看表结构
            desc test;

        查看数据库数据
            select * from dome;

        写入数据库
            insert into dome(m1, m2 , m3, ...) value(data1, data2, data3, ...);
                """
                可修改指定数据，修改那个就写那个mn，若写入数据一一m,那么可以省略不写dome(...)，但这才是标准写法
                也可一次写入多数据
                """

        删除表中数据
            delete from dome where 字段 = "行data";  # 若不指定行，则修改所有数据

        改数据库数据
            update dome set "字段名" = "data" where "行" = "data";

        模糊查询
        select "值" like "%_";

        取消指令
        \c

        指令；between * and *
        select ？ between * and *

        运算符
        指令中可以用+ - * / < > <= >= or and

        判断语法，与python类似
        特殊的类型null，空；但是没有布尔类型

        约束
        unsigned 无符号(正数)
        zerofill 前导零填充
        auto_increment 自增
        default 默认值
        not null 非空
        primary key 主键(非null并不重复)
        unique 唯一性(可以为null但不重复)
        index 常规索引

        约束使用-可以有多个约束-约束尽量不要乱顺序，可能报错
        create table 表名(字段名 类型 字段约束 字段约束..., 字段名 类型 字段约束...);

        展示当前库中的表
        show tables;

        更改字段
        alter table dome add mm int  after name;
        alter table dome drop mm;
        alter table dome change name name_change char(7) not null;

        授权操作
        grant all on mydb.* to zhangsan@"%" identified by "123";

        刷新
        flush privileges;

        移除权限
        revoke 权限 on mydb.* from zhangsan@"%";

        显示用户权限
        show grants for zhangsan@"%";

        删除用户
        drop user zhangsan@"%";

        查看所有用户
        select user,host from mysql.user;

        备份数据库
        mysqldump -u root -p mydome (表,若要指定表的话写上，不指定，备份整个数据库) > mysql1.sql

        恢复数据库
        mysql -u root -p mydome < .\mysql1.sql

        授权:grant 允许操作 on 库名.表名 to 账号@来源 identified by'密码’
        备份:mysqldump -u root -p 数据库名[表名]>文件名.sql
        恢复:mysql-u root -p 数据库名<文件名.sql

        嵌套查询
        select * from stu where age = (select max(age) from stu);

        多表联查
        select s.id, s.name, g.subject, g.score from stu s, grade g where s.id = g.sid,
            """
            将stu临时比作s，将grade临时比作g，然后查询stu的id，name查询grade的subject，score
            但是不可直接回车，否则数据是乱的，必须加上where关联条件查询-----where关联查询是取交集
            """
        select s.id, s.name, g.subject, g.score from stu s left join grade g on s.id = g.sid;
            """
            将stu临时比作s，将grade临时比作g，然后查询stu的id，name查询grade的subject，score
            左联查询，以左为主，没有的补空，on是以什么方式关联，同样可以右联：right join
            还有个内联，inner 是并集
            """

        展示字段
        show columns from %s

        获取当前时间
        now()




Microsoft Windows [版本 10.0.26100.4946]
(c) Microsoft Corporation。保留所有权利。


    # 登录MySQL数据库
    C:\Users\2021>mysql -h localhost -u root -p  # 这里没有密码，所以没写
    Enter password:  # 直接回车

        """
        mysql是命令，数据库叫MySQL
        "-h" 为登录方式(localhost为本地主机登录)
        "-u"为登录用户
        "-p"为登录密码
        # 注意，每个参数之间有空格，除了密码，密码要紧挨着
        """


Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 4
Server version: 5.7.29 MySQL Community Server (GPL)

Copyright (c) 2000, 2020, Oracle and/or its affiliates. All rights reserved.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.


    # "\h"查看系统帮助 "\q"为退出
    mysql> \h


For information about MySQL products and services, visit:
   http://www.mysql.com/
For developer information, including the MySQL Reference Manual, visit:
   http://dev.mysql.com/
To buy MySQL Enterprise support, training, or other products, visit:
   https://shop.mysql.com/

List of all MySQL commands:
Note that all text commands must be first on line and end with ';'
?         (\?) Synonym for `help'.  # 帮助
clear     (\c) Clear the current input statement.  # 清屏
connect   (\r) Reconnect to the server. Optional arguments are db and host.
delimiter (\d) Set statement delimiter.
ego       (\G) Send command to mysql server, display result vertically.
exit      (\q) Exit mysql. Same as quit.  # 退出
go        (\g) Send command to mysql server.
help      (\h) Display this help.  # 帮助
notee     (\t) Don't write into outfile.
print     (\p) Print current command.
prompt    (\R) Change your mysql prompt.
quit      (\q) Quit mysql.  # 退出
rehash    (\#) Rebuild completion hash.
source    (\.) Execute an SQL script file. Takes a file name as an argument.
status    (\s) Get status information from the server.
tee       (\T) Set outfile [to_outfile]. Append everything into given outfile.
use       (\u) Use another database. Takes database name as argument.
charset   (\C) Switch to another charset. Might be needed for processing binlog with multi-byte charsets.
warnings  (\W) Show warnings after every statement.
nowarning (\w) Don't show warnings after every statement.
resetconnection(\x) Clean session context.

For server side help, type 'help contents'


    # "\s"查看系统信息
    mysql> \s


--------------
mysql  Ver 14.14 Distrib 5.7.29, for Win64 (x86_64)

Connection id:          4  # id
Current database:             # 当前数据库，目前没有所以不显示
Current user:           root@localhost  # 当前登录用户，root，本地登录
SSL:                    Cipher in use is ECDHE-RSA-AES128-GCM-SHA256  # 加密方式为ECDHE-RSA-AES128-GCM-SHA256
Using delimiter:        ;  #使用的分隔符为";" 每个语句后面都需要加的符号
Server version:         5.7.29 MySQL Community Server (GPL)  # 服务版本
Protocol version:       10  # 协议版本
Connection:             localhost via TCP/IP  # 连接方式
Server characterset:    latin1  # 服务器字符集
Db     characterset:    latin1  # 数据库字符集
Client characterset:    gbk  # 客户端字符集
Conn.  characterset:    gbk  # 链接字符集
TCP port:               3306  # 进程id
Uptime:                 10 hours 2 min 32 sec  # 启动时间

Threads: 2  Questions: 12  Slow queries: 0  Opens: 106  Flush tables: 1  Open tables: 99  Queries per second avg: 0.000
# 线程2 问题12 慢查询0 打开106 刷新表1 打开表99 每秒查询次数0.000
--------------


    # 数据库查询
    mysql> show databases  # 查询当前用户可查看的所有数据库,查询库database后面加s
        -> ;  # 因为上方没有用分号，所以认为语句还没有写完，什么时候写分号，什么时候结束语句


+--------------------+
| Database           |
+--------------------+
| information_schema |  # 系统库，不要动
| mydome             |  # 自己的库，由你
| mysql              |  # 系统库，不要动
| performance_schema |  # 系统库，不要动
| sys                |  # 系统库，不要动
+--------------------+
5 rows in set (0.00 sec)


    # 创建数据库
    mysql> create database if not exists mydb;  # 创建库，database后面不加s
    # 其中if not exists可以加，也可不加，意思是判断是否有数据此数据库，没有的话创建，有的话报警告，但是没有这个语句的话，是报错


Query OK, 1 row affected (0.00 sec)  # 创建成功


    # 查看当前选择的库
    mysql> select database();


+------------+
| database() |
+------------+
| NULL       |  # 因为没有进入库中，所以是空
+------------+
1 row in set (0.00 sec)


    # 选择库为mydb
    mysql> use mydb


Database changed


    # 再次查看当前选择的库
    mysql> select database();


+------------+
| database() |
+------------+
| mydb       |  # 这里显示的就是当前选择的数据库了，进入库就不能退出去了，但是可以进入其他库
+------------+
1 row in set (0.00 sec)


    # 展示指定数据库的建库语句
    mysql> show create database mydb
    -> ;


+----------+-----------------------------------------------------------------+
| Database | Create Database                                                 |
+----------+-----------------------------------------------------------------+
| mydb     | CREATE DATABASE `mydb` /*!40100 DEFAULT CHARACTER SET latin1 */ |
+----------+-----------------------------------------------------------------+
1 row in set (0.00 sec)


    # 后面加G是文本方式输出
    mysql> show create database mydb\G;


*************************** 1. row ***************************
       Database: mydb
Create Database: CREATE DATABASE `mydb` /*!40100 DEFAULT CHARACTER SET latin1 */  # 字符编码为latin1
1 row in set (0.00 sec)

ERROR:
No query specified


    mysql> show create database mydome\G;


*************************** 1. row ***************************
       Database: mydome
Create Database: CREATE DATABASE `mydome` /*!40100 DEFAULT CHARACTER SET utf8 */  # 注意，这里是utf8的编码，而上方是latin1,
1 row in set (0.00 sec)

ERROR:
No query specified


    # 删除数据库
    mysql> drop database mydb;


Query OK, 0 rows affected (0.00 sec)


    # 重新创建字符编码为utf8的数据库
    mysql> CREATE DATABASE `mydb` /*!40100 DEFAULT CHARACTER SET utf8 */  # 直接复制然后改一下字符编码
        -> ;


Query OK, 1 row affected (0.00 sec)


    mysql> use mydome


Database changed


    # 查看表users中的所有数据
    mysql> select * from users;


+----+------+------+--------------+
| id | name | age  | address      |
+----+------+------+--------------+
|  1 | 2021 |   20 | testtesttest |
|  2 | 2022 |   11 | 11111        |
+----+------+------+--------------+
2 rows in set (0.00 sec)


    # 新建表，字段m1为int类型，字段m2为字符串类型（8个字符）
    mysql> create table aa(m1 int, m2 varchar(8));


Query OK, 0 rows affected (0.05 sec)


    mysql> show tables;


+----------------+
| Tables_in_mydb |
+----------------+
| aa             |
+----------------+
1 row in set (0.00 sec)


    # 查看aa表的表结构
    mysql> desc aa;


+-------+------------+------+-----+---------+-------+
| Field | Type       | Null | Key | Default | Extra |
+-------+------------+------+-----+---------+-------+
| m1    | int(11)    | YES  |     | NULL    |       |
| m2    | varchar(8) | YES  |     | NULL    |       |
+-------+------------+------+-----+---------+-------+
2 rows in set (0.00 sec)


    mysql> drop table aa;


Query OK, 0 rows affected (0.01 sec)


    # 创建表
    mysql> create table dome(
        -> id int,
        -> name varchar(7),  # 每次写完一个参数要加个逗号，字符串类型需要指定长度
        -> age int,
        -> sex enum('w', 'm')  # 多选一，enum类型数据
        -> );  # 写完记得加括号与分号


Query OK, 0 rows affected (0.04 sec)


    # desc查看表结构
    mysql> desc dome;


+-------+---------------+------+-----+---------+-------+
| Field | Type          | Null | Key | Default | Extra |
+-------+---------------+------+-----+---------+-------+
| id    | int(11)       | YES  |     | NULL    |       |
| name  | varchar(7)    | YES  |     | NULL    |       |
| age   | int(11)       | YES  |     | NULL    |       |
| sex   | enum('w','m') | YES  |     | NULL    |       |
+-------+---------------+------+-----+---------+-------+
4 rows in set (0.00 sec)


    # 查看建表语句
    mysql> show create table dome\G;


*************************** 1. row ***************************
       Table: dome
Create Table: CREATE TABLE `dome` (
  `id` int(11) DEFAULT NULL,
  `name` varchar(7) DEFAULT NULL,
  `age` int(11) DEFAULT NULL,
  `sex` enum('w','m') DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8
1 row in set (0.00 sec)

ERROR:
No query specified


    # 写入数据-----标准写法
    mysql> insert into dome(id, name, age, sex) value(1, "2021", 19, "m");  # 必须一一对应


Query OK, 1 row affected (0.00 sec)


    # 也可添加多条数据
    mysql> insert into dome(id, name, age, sex) value(2, "2022", 20, "m"), (3, "2023", 21, "w");


Query OK, 2 rows affected (0.02 sec)
Records: 2  Duplicates: 0  Warnings: 0


    # 也可添加指定数据
    mysql> insert into dome(id, name) value(4, "2024");


Query OK, 1 row affected (0.01 sec)


    # 如果值已经一一对应，那么可以省略不写指定字段
    mysql> insert into dome value (5, "2025", 20, "m");


Query OK, 1 row affected (0.03 sec)


    # 显示数据
    mysql> select * from dome;


+------+------+------+------+
| id   | name | age  | sex  |
+------+------+------+------+
|    1 | 2021 |   19 | m    |
|    2 | 2022 |   20 | m    |
|    3 | 2023 |   21 | w    |
|    4 | 2024 | NULL | NULL |
|    5 | 2025 |   20 | m    |
+------+------+------+------+
5 rows in set (0.00 sec)


    # 更新数据
    mysql> update dome set sex = "w" where name = "2024";
    # set设置，第一个为列，第二个为需要修改的对象，若不指定对象，那么修改所有对象

Query OK, 1 row affected (0.01 sec)
Rows matched: 1  Changed: 1  Warnings: 0


    # 修改所有年龄
    mysql> update dome set age = age + 1;


Query OK, 4 rows affected (0.00 sec)
Rows matched: 5  Changed: 4  Warnings: 0


    # 删除数据
    mysql> delete from dome where name = "2021";
    # 删除指定对象，若不指明对象，将干掉所有数据！！！

Query OK, 1 row affected (0.01 sec)


# 判断前两个字段是否相等
    mysql> select "2022" like "20%";


+-------------------+
| "2022" like "20%" |
+-------------------+
|                 1 |  # 回答0(假)或1(真)
+-------------------+
1 row in set (0.00 sec)


    # 也可判断是否也某某结尾
    mysql> select "2022" like "%1";


+------------------+
| "2022" like "%1" |
+------------------+
|                0 |
+------------------+
1 row in set (0.00 sec)


    # 前后模糊查询
    mysql> select "2022" like "2%1";


+-------------------+
| "2022" like "2%1" |
+-------------------+
|                 0 |
+-------------------+
1 row in set (0.00 sec)


    # 知道少几个字符，但不知道具体，可以用下划线代替
    mysql> select "2022" like "2__2";


+--------------------+
| "2022" like "2__2" |
+--------------------+
|                  1 |
+--------------------+
1 row in set (0.00 sec)


    # 中间是否有0
    mysql> select "2022" like "%0%";


+-------------------+
| "2022" like "%0%" |
+-------------------+
|                 1 |
+-------------------+
1 row in set (0.00 sec)



    mysql> create table stu(
        -> id int unsigned not null auto_increment primary key,
        -> name varchar(7) not null unique,
        -> age tinyint,
        -> sex enum("w", "m") default "m",
        -> classid char(8) not null
        -> );


Query OK, 0 rows affected (0.03 sec)


    mysql> desc stu;


+---------+------------------+------+-----+---------+----------------+
| Field   | Type             | Null | Key | Default | Extra          |
+---------+------------------+------+-----+---------+----------------+
| id      | int(10) unsigned | NO   | PRI | NULL    | auto_increment |
| name    | varchar(7)       | NO   | UNI | NULL    |                |
| age     | tinyint(4)       | YES  |     | NULL    |                |
| sex     | enum('w','m')    | YES  |     | m       |                |
| classid | char(8)          | NO   |     | NULL    |                |
+---------+------------------+------+-----+---------+----------------+
5 rows in set (0.01 sec)


    更改字段
    mysql> alter table dome add mm int  after name;


Query OK, 0 rows affected (0.09 sec)
Records: 0  Duplicates: 0  Warnings: 0


    mysql> desc dome;


+-------+---------------+------+-----+---------+----------------+
| Field | Type          | Null | Key | Default | Extra          |
+-------+---------------+------+-----+---------+----------------+
| id    | int(11)       | NO   | PRI | NULL    | auto_increment |
| name  | varchar(7)    | YES  |     | NULL    |                |
| mm    | int(11)       | YES  |     | NULL    |                |
| age   | tinyint(4)    | YES  |     | NULL    |                |
| sex   | enum('w','m') | YES  |     | NULL    |                |
+-------+---------------+------+-----+---------+----------------+
5 rows in set (0.00 sec)


mysql> alter table dome drop mm;


Query OK, 0 rows affected (0.11 sec)
Records: 0  Duplicates: 0  Warnings: 0


    mysql> alter table dome change name name_change char(7) not null;


Query OK, 1 row affected (0.09 sec)
Records: 1  Duplicates: 0  Warnings: 0


    mysql> insert into stu(id, name, age, sex, classid) value(1, "2021", 20, "m", "python01");


Query OK, 1 row affected (0.04 sec)


    mysql> insert into stu(name, age, sex, classid) value("afadfe", 22, "w", "python02");


Query OK, 1 row affected (0.01 sec)


    mysql> insert into stu(id, name, age, sex, classid) value(null, "2ead", 19, "m", "pyth01");


Query OK, 1 row affected (0.02 sec)


    mysql> insert into value(null, "2eadee", 18, "w", "pyth001");


    mysql> insert into stu value(null, "2eadee", 18, "w", "pyth001");


Query OK, 1 row affected (0.01 sec)


    mysql> select * from stu;


+----+--------+------+------+----------+
| id | name   | age  | sex  | classid  |
+----+--------+------+------+----------+
|  1 | 2021   |   20 | m    | python01 |
|  2 | afadfe |   22 | w    | python02 |
|  3 | 2ead   |   19 | m    | pyth01   |
|  4 | 2eadee |   18 | w    | pyth001  |
+----+--------+------+------+----------+
4 rows in set (0.00 sec)


    mysql> insert into stu(name, classid) values("2eaadd", "pyath01"), ("2022", "python04"), ("202de", "python05");


Query OK, 3 rows affected (0.02 sec)
Records: 3  Duplicates: 0  Warnings: 0


    mysql> update stu set age = age + 2, sex = "w" where id in (2, 4, 6);


Query OK, 2 rows affected (0.03 sec)
Rows matched: 2  Changed: 2  Warnings: 0


    mysql> select * from stu;


+----+--------+------+------+----------+
| id | name   | age  | sex  | classid  |
+----+--------+------+------+----------+
|  1 | 2021   |   20 | m    | python01 |
|  2 | afadfe |   24 | w    | python02 |
|  3 | 2ead   |   19 | m    | pyth01   |
|  4 | 2eadee |   20 | w    | pyth001  |
| 11 | 2eaadd | NULL | m    | pyath01  |
| 12 | 2022   | NULL | m    | python04 |
| 13 | 202de  | NULL | m    | python05 |
+----+--------+------+------+----------+
7 rows in set (0.00 sec)


    mysql> delete from stu where id = 55;


Query OK, 0 rows affected (0.00 sec)


    mysql> delete from stu where id = 55;


Query OK, 0 rows affected (0.00 sec)


    mysql> select id, name, age from stu;


+----+--------+------+
| id | name   | age  |
+----+--------+------+
|  1 | 2021   |   20 |
|  2 | afadfe |   24 |
|  3 | 2ead   |   19 |
|  4 | 2eadee |   20 |
| 11 | 2eaadd | NULL |
| 12 | 2022   | NULL |
| 13 | 202de  | NULL |
+----+--------+------+
7 rows in set (0.00 sec)


    mysql> select id as uid, name, age from stu;


+-----+--------+------+
| uid | name   | age  |
+-----+--------+------+
|   1 | 2021   |   20 |
|   2 | afadfe |   24 |
|   3 | 2ead   |   19 |
|   4 | 2eadee |   20 |
|  11 | 2eaadd | NULL |
|  12 | 2022   | NULL |
|  13 | 202de  | NULL |
+-----+--------+------+
7 rows in set (0.00 sec)


    mysql> select id as uid, name, age = age + 4 from stu;


+-----+--------+---------------+
| uid | name   | age = age + 4 |
+-----+--------+---------------+
|   1 | 2021   |             0 |
|   2 | afadfe |             0 |
|   3 | 2ead   |             0 |
|   4 | 2eadee |             0 |
|  11 | 2eaadd |          NULL |
|  12 | 2022   |          NULL |
|  13 | 202de  |          NULL |
+-----+--------+---------------+
7 rows in set (0.00 sec)


    mysql> select id as uid, name, age + 4 from stu;


+-----+--------+---------+
| uid | name   | age + 4 |
+-----+--------+---------+
|   1 | 2021   |      24 |
|   2 | afadfe |      28 |
|   3 | 2ead   |      23 |
|   4 | 2eadee |      24 |
|  11 | 2eaadd |    NULL |
|  12 | 2022   |    NULL |
|  13 | 202de  |    NULL |
+-----+--------+---------+
7 rows in set (0.00 sec)


    mysql> select *, "beijing" as city from stu;


+----+--------+------+------+----------+---------+
| id | name   | age  | sex  | classid  | city    |
+----+--------+------+------+----------+---------+
|  1 | 2021   |   20 | m    | python01 | beijing |
|  2 | afadfe |   24 | w    | python02 | beijing |
|  3 | 2ead   |   19 | m    | pyth01   | beijing |
|  4 | 2eadee |   20 | w    | pyth001  | beijing |
| 11 | 2eaadd | NULL | m    | pyath01  | beijing |
| 12 | 2022   | NULL | m    | python04 | beijing |
| 13 | 202de  | NULL | m    | python05 | beijing |
+----+--------+------+------+----------+---------+
7 rows in set (0.00 sec)


    mysql> select * from stu where age > 25;


Empty set (0.00 sec)


    mysql> select * from stu where age > 20;


+----+--------+------+------+----------+
| id | name   | age  | sex  | classid  |
+----+--------+------+------+----------+
|  2 | afadfe |   24 | w    | python02 |
+----+--------+------+------+----------+
1 row in set (0.00 sec)


    mysql> select * from stu where 20 < age < 25;


+----+--------+------+------+----------+
| id | name   | age  | sex  | classid  |
+----+--------+------+------+----------+
|  1 | 2021   |   20 | m    | python01 |
|  2 | afadfe |   24 | w    | python02 |
|  3 | 2ead   |   19 | m    | pyth01   |
|  4 | 2eadee |   20 | w    | pyth001  |
+----+--------+------+------+----------+
4 rows in set (0.00 sec)


    mysql> select * from stu where age > 20 and age < 25;


+----+--------+------+------+----------+
| id | name   | age  | sex  | classid  |
+----+--------+------+------+----------+
|  2 | afadfe |   24 | w    | python02 |
+----+--------+------+------+----------+
1 row in set (0.00 sec)


    mysql> select * from stu;


+----+--------+------+------+----------+
| id | name   | age  | sex  | classid  |
+----+--------+------+------+----------+
|  1 | 2021   |   20 | m    | python01 |
|  2 | afadfe |   24 | w    | python02 |
|  3 | 2ead   |   19 | m    | pyth01   |
|  4 | 2eadee |   20 | w    | pyth001  |
| 11 | 2eaadd | NULL | m    | pyath01  |
| 12 | 2022   | NULL | m    | python04 |
| 13 | 202de  | NULL | m    | python05 |
+----+--------+------+------+----------+
7 rows in set (0.00 sec)


    mysql> select count(id) from stu;


+-----------+
| count(id) |
+-----------+
|         7 |
+-----------+
1 row in set (0.00 sec)


mysql> select count(id), max(age), avg(age) from stu;


+-----------+----------+----------+
| count(id) | max(age) | avg(age) |
+-----------+----------+----------+
|         7 |       24 |  20.7500 |
+-----------+----------+----------+
1 row in set (0.00 sec)


    mysql> select classid from stu;


+----------+
| classid  |
+----------+
| python01 |
| python02 |
| pyth01   |
| pyth001  |
| pyath01  |
| python04 |
| python05 |
+----------+
7 rows in set (0.00 sec)


    mysql> select classid from stu group by classid;


+----------+
| classid  |
+----------+
| pyath01  |
| pyth001  |
| pyth01   |
| python01 |
| python02 |
| python04 |
| python05 |
+----------+
7 rows in set (0.00 sec)


    mysql> select classid, avg(age) from stu group by classid;


+----------+----------+
| classid  | avg(age) |
+----------+----------+
| pyath01  |     NULL |
| pyth001  |  20.0000 |
| pyth01   |  19.0000 |
| python01 |  20.0000 |
| python02 |  24.0000 |
| python04 |     NULL |
| python05 |     NULL |
+----------+----------+
7 rows in set (0.00 sec)


    mysql> select classid, avg(age), count(id) from stu group by classid;


+----------+----------+-----------+
| classid  | avg(age) | count(id) |
+----------+----------+-----------+
| pyath01  |     NULL |         1 |
| pyth001  |  20.0000 |         1 |
| pyth01   |  19.0000 |         1 |
| python01 |  20.0000 |         1 |
| python02 |  24.0000 |         1 |
| python04 |     NULL |         1 |
| python05 |     NULL |         1 |
+----------+----------+-----------+
7 rows in set (0.00 sec)


    mysql> select classid, avg(age), count(*) from stu group by classid;


+----------+----------+----------+
| classid  | avg(age) | count(*) |
+----------+----------+----------+
| pyath01  |     NULL |        1 |
| pyth001  |  20.0000 |        1 |
| pyth01   |  19.0000 |        1 |
| python01 |  20.0000 |        1 |
| python02 |  24.0000 |        1 |
| python04 |     NULL |        1 |
| python05 |     NULL |        1 |
+----------+----------+----------+
7 rows in set (0.00 sec)


    mysql> select classid, avg(age), count(*) from stu group by classid having avg(age) > 19;


+----------+----------+----------+
| classid  | avg(age) | count(*) |
+----------+----------+----------+
| pyth001  |  20.0000 |        1 |
| python01 |  20.0000 |        1 |
| python02 |  24.0000 |        1 |
+----------+----------+----------+
3 rows in set (0.00 sec)


    mysql> select * from stu;


+----+--------+------+------+----------+
| id | name   | age  | sex  | classid  |
+----+--------+------+------+----------+
|  1 | 2021   |   20 | m    | python01 |
|  2 | afadfe |   24 | w    | python02 |
|  3 | 2ead   |   19 | m    | pyth01   |
|  4 | 2eadee |   20 | w    | pyth001  |
| 11 | 2eaadd | NULL | m    | pyath01  |
| 12 | 2022   | NULL | m    | python04 |
| 13 | 202de  | NULL | m    | python05 |
+----+--------+------+------+----------+
7 rows in set (0.00 sec)


    mysql> select * from stu order by age;


+----+--------+------+------+----------+
| id | name   | age  | sex  | classid  |
+----+--------+------+------+----------+
| 11 | 2eaadd | NULL | m    | pyath01  |
| 12 | 2022   | NULL | m    | python04 |
| 13 | 202de  | NULL | m    | python05 |
|  3 | 2ead   |   19 | m    | pyth01   |
|  1 | 2021   |   20 | m    | python01 |
|  4 | 2eadee |   20 | w    | pyth001  |
|  2 | afadfe |   24 | w    | python02 |
+----+--------+------+------+----------+
7 rows in set (0.00 sec)


    mysql> select * from stu order by age desc;


+----+--------+------+------+----------+
| id | name   | age  | sex  | classid  |
+----+--------+------+------+----------+
|  2 | afadfe |   24 | w    | python02 |
|  1 | 2021   |   20 | m    | python01 |
|  4 | 2eadee |   20 | w    | pyth001  |
|  3 | 2ead   |   19 | m    | pyth01   |
| 11 | 2eaadd | NULL | m    | pyath01  |
| 12 | 2022   | NULL | m    | python04 |
| 13 | 202de  | NULL | m    | python05 |
+----+--------+------+------+----------+
7 rows in set (0.00 sec)


    mysql> select * from stu order by classid asc, age desc;


+----+--------+------+------+----------+
| id | name   | age  | sex  | classid  |
+----+--------+------+------+----------+
| 11 | 2eaadd | NULL | m    | pyath01  |
|  4 | 2eadee |   20 | w    | pyth001  |
|  3 | 2ead   |   19 | m    | pyth01   |
|  1 | 2021   |   20 | m    | python01 |
|  2 | afadfe |   24 | w    | python02 |
| 12 | 2022   | NULL | m    | python04 |
| 13 | 202de  | NULL | m    | python05 |
+----+--------+------+------+----------+
7 rows in set (0.00 sec)


    mysql> select * from stu limit 3;


+----+--------+------+------+----------+
| id | name   | age  | sex  | classid  |
+----+--------+------+------+----------+
|  1 | 2021   |   20 | m    | python01 |
|  2 | afadfe |   24 | w    | python02 |
|  3 | 2ead   |   19 | m    | pyth01   |
+----+--------+------+------+----------+
3 rows in set (0.00 sec)


    mysql> select * from stu limit 3,3;


+----+--------+------+------+----------+
| id | name   | age  | sex  | classid  |
+----+--------+------+------+----------+
|  4 | 2eadee |   20 | w    | pyth001  |
| 11 | 2eaadd | NULL | m    | pyath01  |
| 12 | 2022   | NULL | m    | python04 |
+----+--------+------+------+----------+
3 rows in set (0.00 sec)


    mysql> select * from stu limit 6,3;


+----+-------+------+------+----------+
| id | name  | age  | sex  | classid  |
+----+-------+------+------+----------+
| 13 | 202de | NULL | m    | python05 |
+----+-------+------+------+----------+
1 row in set (0.00 sec)


    mysql> \s


--------------
mysql  Ver 14.14 Distrib 5.7.29, for Win64 (x86_64)

Connection id:          3
Current database:       mydome
Current user:           root@localhost
SSL:                    Cipher in use is ECDHE-RSA-AES128-GCM-SHA256
Using delimiter:        ;
Server version:         5.7.29 MySQL Community Server (GPL)
Protocol version:       10
Connection:             localhost via TCP/IP
Server characterset:    latin1
Db     characterset:    utf8
Client characterset:    gbk
Conn.  characterset:    gbk
TCP port:               3306
Uptime:                 3 hours 30 min 52 sec

Threads: 2  Questions: 244  Slow queries: 0  Opens: 117  Flush tables: 1  Open tables: 103  Queries per second avg: 0.019
--------------


    授权
    mysql> grant all on mydb.* to zhangsan@"%" identified by "123";


Query OK, 0 rows affected, 1 warning (0.01 sec)


    刷新
    mysql> flush privileges;


Query OK, 0 rows affected (0.00 sec)


    mysql> quit


Bye


    C:\Users\2021>mysql -u root


Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 5
Server version: 5.7.29 MySQL Community Server (GPL)

Copyright (c) 2000, 2020, Oracle and/or its affiliates. All rights reserved.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

    mysql> select user, host from mysql.user
        -> ;


+---------------+-----------+
| user          | host      |
+---------------+-----------+
| zhangsan      | %         |
| mysql.session | localhost |
| mysql.sys     | localhost |
| root          | localhost |
+---------------+-----------+
4 rows in set (0.00 sec)


    mysql> revoke delete on mydb.* from zhangsan@"%";


Query OK, 0 rows affected (0.00 sec)


    显示用户权限
    mysql> show grants for zhangsan@"%";


+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Grants for zhangsan@%                                                                                                                                                                                                    |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| GRANT USAGE ON *.* TO 'zhangsan'@'%'                                                                                                                                                                                     |
| GRANT SELECT, INSERT, UPDATE, CREATE, DROP, REFERENCES, INDEX, ALTER, CREATE TEMPORARY TABLES, LOCK TABLES, EXECUTE, CREATE VIEW, SHOW VIEW, CREATE ROUTINE, ALTER ROUTINE, EVENT, TRIGGER ON `mydb`.* TO 'zhangsan'@'%' |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
2 rows in set (0.00 sec)


    删除用户
    mysql> drop user zhangsan@"%";


Query OK, 0 rows affected (0.00 sec)


    查看用户
    mysql> select user,host from mysql.user;


+---------------+-----------+
| user          | host      |
+---------------+-----------+
| mysql.session | localhost |
| mysql.sys     | localhost |
| root          | localhost |
+---------------+-----------+
3 rows in set (0.00 sec)


    备份数据库
    mysqldump -u root -p mydome > mysql1.sql


    恢复数据库
    C:\Users\2021\Desktop>mysql -u root -p mydome < .\mysql1.sql
    Enter password:


    嵌套查询
    mysql> select * from stu where age = (select max(age) from stu);


+----+--------+------+------+----------+
| id | name   | age  | sex  | classid  |
+----+--------+------+------+----------+
|  2 | afadfe |   24 | w    | python02 |
+----+--------+------+------+----------+
1 row in set (0.00 sec)

























